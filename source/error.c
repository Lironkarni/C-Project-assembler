#include "../headers/error.h"
#include "../headers/globals.h"

/* Array of defined errors and corresponding messages */
error errors[]={
    {ERROR_CODE_0, "NO ERROR FOUND"},
    {ERROR_CODE_1, "NO FILES ENTERED, CAN'T RUN PROGRAM"},
    {ERROR_CODE_2, "FILE DOES NOT EXISTS"},
    {ERROR_CODE_3, "FAILED TO ALLOCATE MEMORY"},
    {ERROR_CODE_4, "FAIL TO OPEN FILE"},
    {ERROR_CODE_5, "ERROR: UNABLE TO OPEN FOR READING"},
    {ERROR_CODE_6, "ERROR: UNABLE TO OPEN FOR WRITING"},
    {ERROR_CODE_7, "ERROR: DELETING FILE"},
    {ERROR_CODE_8, "THE LINE IS TOO LONG, MORE THAN CHARACTERS"},
    {ERROR_CODE_9, "LABEL NAME IS INVALID, CANNOT BE ASSEMBLY INSTUCTION NAME"},
    {ERROR_CODE_10, "LABEL NAME IS INVALID, LABEL NAME MUST START WITH ALPHABETIC CHAR"},
    {ERROR_CODE_11, "LABEL NAME IS INVALID, MORE THAN 31 CHARS"},
    {ERROR_CODE_12, "LABEL NAME IS INVALID, LABEL SHOULD CONTAIN ALPHABETIC AND DIGITS ONLY"},
    {ERROR_CODE_13, "MACRO NAME IS INVALID (CANNOT BE AN DIRECTIVE NAME)."},
    {ERROR_CODE_14, "MACRO NAME IS INVALID (CANNOT BE AN INSTRUCTION NAME)."},
    {ERROR_CODE_15, "EXTRA CHARACTERS FOUND IN MACRO OPEN LINE."},
    {ERROR_CODE_16, "EXTRA CHARACTERS FOUND IN MACRO CLOSE LINE."},
    {ERROR_CODE_17, "ERROR: LABEL NAME IS INVALID, LABEL NAME CANNOT BE EQUAL TO MACRO NAME"},
    {ERROR_CODE_18, "LABEL NAME IS ALREADY EXISTS"},
    {ERROR_CODE_19, "LABEL NAME CANNOT BE REGISTER NAME"},
    {ERROR_CODE_20, "STRING INSTRUCTION IS NOT IN QUOTES"},
    {ERROR_CODE_21, "EXTRANEOUS TEXT AFTER END OF COMMAND"},
    {ERROR_CODE_22, "EXPECTED NUMBER IN DATA INTRUCTION"},
    {ERROR_CODE_23, "MISSING COMMA BETWEEN NUMBERS DATA INTRUCTION"},
    {ERROR_CODE_24, "DATA INTRUCTION CANNOT END WITH COMMA"},
    {ERROR_CODE_25, "UNRECOGNIZED COMMAND, CHECK SYNTAX"},
    {ERROR_CODE_26, "THIS OPERATION IS MISSING OPERAND"},
    {ERROR_CODE_27, "MISSING COMMA BETWEEN OPERANDS"},
    {ERROR_CODE_28, "ILLEGAL COMMA BETWEEN OPERATION NAME AND OPERAND"},
    {ERROR_CODE_29, "ILLEGAL COMMA | EXPECTED ONLY ONE OPERAND"},
    {ERROR_CODE_30, "THIS OPERATION IS MISSING OPERANDS"},
    {ERROR_CODE_31, "EXPECTED NUMERIC CHARACTERS IN DIRECT ADDRESSING"},
    {ERROR_CODE_32, "NOT VALID TO USE & FOR OPERATIONS THAT NOT JMP/BNE/JSR"},
    {ERROR_CODE_33, "INVALID COMMAND | EXPECTED COMMA BETWEEN OPERANDS"},
    {ERROR_CODE_34, "THIS OPERATION USE ILLEGAL ADDRESSING METHOD TO DESTINATION OPERAND"},
    {ERROR_CODE_35, "INVALID COMMA | EXPECTING ONLY ONE COMMA IN THIS OPERATION"},
    {ERROR_CODE_36, "INVALID OPERAND | OPERAND IS OUT OF 'IMMEDIATE' METHOD TYPE RANGE (21BITS)"},
    {ERROR_CODE_37, "IC GOT TO LIMIT, CAN'T ADD TO MEMORY"},
    {ERROR_CODE_38, "LABEL IS DECLARED AS A LABEL AND AS AN EXTERN ON SAME FILE"},
    {ERROR_CODE_39, "LABEL IS DECLARED AS AN ENTRY AND NOT AS AN LABEL ON SAME FILE"},
    {ERROR_CODE_40, "LABEL IS BEEN USED AS OPERAND BUT DID NOT DECLARED AS A LABEL"},
    {ERROR_CODE_41, "NUMBERS IN DATA INSTRUCTION SHOULD BE INTEGER NUMBERS ONLY (NOT DECIMAL)"},
    {ERROR_CODE_42, "OPERAND OF KIND NUMBER (#) SHOULD BE INTEGER (NOT DECIMAL)"}
};


int FOUND_ERROR_IN_PRE_ASSEMBLER = 0;
int FOUND_ERROR_IN_FIRST_PASS=0;
int FOUND_ERROR_IN_SECOND_PASS=0;

void print_system_error(int error_code){
    if(error_code==ERROR_CODE_4){
        FOUND_ERROR_IN_FIRST_PASS=1; /* mark error encountered in first pass */
    }
    printf("ERROR: code %d | %s\n",error_code, errors[error_code].err_message);
}


void print_syntax_error(int error_code, const char* file_name, int line_number)
{
    if (error_code==ERROR_CODE_16 ||error_code==ERROR_CODE_14||error_code==ERROR_CODE_15 ||error_code==ERROR_CODE_13 ){
        FOUND_ERROR_IN_PRE_ASSEMBLER = 1; /* mark error encountered in pre-assembly phase */
    }
    printf("ERROR: code %d | in file: %s | at line: %d \n%s\n", error_code, file_name, line_number, errors[error_code].err_message);
}

